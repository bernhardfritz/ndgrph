(()=>{"use strict";var t={829:function(t,e){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.TernaryFunctionNode=e.BinaryFunctionNode=e.UnaryFunctionNode=e.NullaryFunctionNode=void 0;var i=function(t){var e=this;this.inputs=new Array(t.length),this.output=function(){if(-1===e.inputs.indexOf(void 0)){var n=e.inputs.map((function(t){return t()}));return-1!==n.indexOf(void 0)?void 0:t.apply(void 0,n)}}},r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i);e.NullaryFunctionNode=r;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i);e.UnaryFunctionNode=u;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i);e.BinaryFunctionNode=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i);e.TernaryFunctionNode=c}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=n(829);let e;const o=[],i=(t,n)=>{let i=n?t:void 0,r=n?void 0:t;const u=t=>{n?r=t.target:i=t.target;const u=o.find((t=>-1!==t.view.inputs.indexOf(i))),l=o.find((t=>t.view.output===r));void 0!==u&&void 0!==l&&(u.model.inputs[u.view.inputs.indexOf(i)]=l.model.output,console.log(u.model.output())),e=void 0,document.onmouseup=null,document.onmousemove=null,s()},l=t=>{(t=t||window.event).preventDefault(),e=[c(n?i:r),[t.clientX,t.clientY]],s()};t.onmousedown=t=>{(t=t||window.event).preventDefault(),e=[c(n?i:r),[window.scrollX+t.clientX,window.scrollY+t.clientY]],document.onmouseup=u,document.onmousemove=l,s()}},r=t=>{const e=document.getElementById("nodes"),n=u(e),o=n.querySelector(".node__inputs"),r=[];for(let e=0;e<t;e++){const t=l(o);t.querySelector(".node__input-label").textContent=`input[${e}]`;const n=t.querySelector(".node__input-port");i(n,!0),r.push(n)}const c=n.querySelector(".node__output").querySelector(".node__output-port");i(c,!1);const d=c;return(t=>{let e=0,n=0,o=0,i=0;const r=()=>{document.onmouseup=null,document.onmousemove=null},u=r=>{(r=r||window.event).preventDefault(),e=o-r.clientX,n=i-r.clientY,o=r.clientX,i=r.clientY,t.style.top=t.offsetTop-n+"px",t.style.left=t.offsetLeft-e+"px",s()},l=t=>{(t=t||window.event).preventDefault(),o=t.clientX,i=t.clientY,document.onmouseup=r,document.onmousemove=u},c=t.querySelector(".node__header");c?c.onmousedown=l:t.onmousedown=l})(n),{inputs:r,output:d}},u=t=>{const e=document.getElementById("node-template");t.appendChild(e.content.cloneNode(!0));const n=t.querySelectorAll(".node");return n[n.length-1]},l=t=>{const e=document.getElementById("node-input-template");t.appendChild(e.content.cloneNode(!0));const n=t.querySelectorAll(".node__input");return n[n.length-1]},c=t=>{const e=t.getBoundingClientRect();return[e.left+(e.right-e.left)/2,e.top+(e.bottom-e.top)/2]},d=(t,e,n)=>{t.beginPath(),t.moveTo(e[0],e[1]),t.bezierCurveTo(n[0],e[1],e[0],n[1],n[0],n[1]),t.strokeStyle="rgb(255, 255, 255)",t.stroke()},s=()=>{const t=document.getElementById("canvas"),n=t.clientWidth,i=t.clientHeight;t.width===n&&t.height===i||(t.width=n,t.height=i);const r=t.getContext("2d");r.fillStyle="rgb(35, 35, 35)",r.fillRect(0,0,t.width,t.height);for(let e=0;e<Math.ceil((window.scrollY+t.height)/32);e++){const n=32*e-window.scrollY;r.beginPath(),r.moveTo(0,n),r.lineTo(t.width,n),r.lineWidth=e%5==0?2:1,r.strokeStyle="rgb(25, 25, 25)",r.stroke()}for(let e=0;e<Math.ceil((window.scrollX+t.width)/32);e++){const n=32*e-window.scrollX;r.beginPath(),r.moveTo(n,0),r.lineTo(n,t.height),r.lineWidth=e%5==0?2:1,r.strokeStyle="rgb(25, 25, 25)",r.stroke()}for(let t=0;t<o.length;t++)for(let e=0;e<o.length;e++)if(t!==e)for(let n=0;n<o[t].model.inputs.length;n++)if(o[t].model.inputs[n]===o[e].model.output){const i=c(o[t].view.inputs[n]),u=c(o[e].view.output);d(r,i,u)}if(void 0!==e){const[t,n]=e;d(r,t,n)}};document.onscroll=t=>{s()},window.onresize=t=>{s()},s(),window.addValueNode=()=>{const e=+prompt(),n=new t.NullaryFunctionNode((()=>e)),i={model:n,view:r(n.inputs.length)};o.push(i)},window.addSumNode=()=>{const e=new t.BinaryFunctionNode(((t,e)=>t+e)),n={model:e,view:r(e.inputs.length)};o.push(n)}})()})();